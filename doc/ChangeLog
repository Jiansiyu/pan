  ChangeLog
  =========

This is a detailed list of ongoing changes.  Add changes to 
the top of this file.

Changes by R. Holmes on 13 Mar 2002
----------------------------------------

TaCutInterval.cc

  o Bug fix: Intervals starting at an event number less than the
    before-extension size were handled incorrectly due to unsigned
    arithmetic. 

TaCutList.cc

  o Multiply extensions from db (now regarded as number of windows) by
    oversample factor to get number of events.
  o Add debug code.

TaRun.cc

  o Better labelling of stats outputs to clarify incremental and
    cumulative stats.
  o Now compute and print stats on all quantities except those
    starting with "Right" or "Left".  This is still something of a
    kludge, but it's a better kludge.

VaAnalysis.hh,cc

  o Replace pair_ok in tree with ok_cond and ok_cut.

VaPair.hh,cc

  o Add PassedCutsInt().


More changes by R. Holmes on 7 Mar 2002
----------------------------------------

TaCutList.cc

  o Return stream from operator<<.
  o Check cut numbers when initializing from database and ignore any
    out of range.

TaCutInterval.cc

  o Return stream from operator<<.


Changes by R. Holmes on 7 Mar 2002
----------------------------------------

TaCutInterval.hh,cc

  o Add operator<< .

TaCutList.hh,cc

  o Initialize cut list and cut extensions from database. (This
    requires a change to the Init interface.) 
  o Add operator<< .

TaEvent.hh,cc

  o Replace data member fCut with fCutFail and fCutPass. 
  o Clear these when loading an event (I'm not sure this is
    necessary). 
  o Call badly-named AddCut for every event cut on every event, with
    value zero when cut is passed, nonzero otherwise.
  o Add GetCutsPassed() as counterpart to GetCuts() (which returns
    cuts failed). 

TaPairFromPair.cc

  o Call badly-named AddCut for every pair cut on every pair, with
  value zero when cut is passed, nonzero otherwise.

TaRun.cc

  o Minor changes required due to above changes in TaCutList and
    TaEvent.
  o A couple of new debug prints (enabled with NOISY).

VaAnalysis.hh,cc

  o Fixed members of pair tree (event numbers and pair_ok) are stored
    in their own variables, not in *fTreeSpace.
  o Initialize fEHelDequeMax to 1 greater than delay * oversample (and 
    eliminate special treatment for delay = 0.)
  o Eliminate "dirty fix" for memory leak (now plugged).

VaPair.cc

  o Change sign convention for differences and asymmetries back to 
    R-L.  (I did this because it is the convention used in HAPPEX I
    and so far as I know all other parity experiments, and because I
    do not know the reason why it was changed to L-R.  If there is a
    problem with R-L please let me know.  There may be a better fix.)
  o Change PassedCuts to return Bool_t, and require both events to be
    good.


Changes by R. Holmes on 5 Mar 2002
----------------------------------------

TaBeamAna 

  o Fix bug in InitChanLists causing BCM asymmetries to be stored
    twice. 

TaRun

  o Changes to prevent Pan from trying to compute and print means and
    widths of things like the helicity and pairsynch bits.  I decided
    on a quick and easy but not necessarily best fix, which is to
    accumulate sums for all "results" (including values of helicity
    and pairsynch) but compute and print means and widths only for
    those whose names start with "Asym" or "Diff".  I would be happy
    to hear suggestions for a better fix, if you have any.

TaStatistics 

  o Remove the error messages from the Neff routines which were
    printed when the statistics vectors are empty; instead it quietly
    returns zero, which is a sensible thing to return.  I think it
    should be legal to call Neff on a possibly empty statistics
    vector.  You still get error messages if you try to e.g. compute a
    mean on an empty vector.




* changes leading to March 1 2002 version
_________________________________________       

TaAnalysisManager -
   Can choose now between two type of analysis, so now the run type and the anatype could
   be different. We still need to put the ana type in the root file name.
         
        
VaAnalysis -
   Added RunInI() set the value of fEHelDequeMax at 1 in case of no 
   helicity delay. This was the main problem why we didn't have 
   the pair tree after a run.   

TaEvent -
   private variable FirstPS was set to 1 to respect the source 
   convention.

TaRun -
   Added event number (ev_num) explicitly in the tree so we don't have to use scaler1_1 to get it.
   Added SendEPICSInfo( pair< string, Double_t> value, pair<string,Double_t> errvalue) to be able 
   to send feedbacks infos to the source.       


VaAnalysis -
         
   Changed the convention for the asymmetry sign  : L - R  


TaFdbkAna -
         
    Derived from VaAnalysis, this is a 'TaBeamAna'  with charge asymmetry feedback implemented.
    will add PZT info if needed.        
        
        
        
        

* Primary changes leading to Feb 8, 2002 version
------------------------------------------------
 
TaAnalysisManager -
   Root file is now pan_%d.dat where %d = run number
   Upon initialization, the database is checked; if it is 'bad' we exit.

TaAsciiDB -
   Added GetMaxEvents()
   Added SelfCheck() - used by analysis manager.
   
TaBCM -
   Modified naming; restriction enforced that bcm1, bcm2 must be 
   different objects (not sure its a good idea but at least its clarified).

TaBeamAna -
   Uses 'bcm1r' and 'bcm1' for raw and corrected data.
   Got rid of the ifdef's since datamap iterator reset works now
      in VaAnalysis::ChanList and TIR is defined.
    
TaEvent -
   Check if event size is changing (it should not).
   Check that keys are unique within a device (see DATABASE.RULES)
   Clearer error messages if a key is not found or rule above broken.
   Provide GetADCData(slot, chan) method.
   Remove ifdef about TIR since it exists now (existence is checked).
   Add DeviceDump() to check all device data.

TaRun -
   If CHECKOUT defined, makes detailed debug printout.

TaTIR -
   Simplified.
   Add timeslot. 
   Call VaDevice::DataCopy so data shows up in Tree.

VaAnalysis -
   if CHECKOUT defined, makes detailed debug printout.
   GetMaxEvents() works now.
   datamap iterator reset before using NextDataMap, this part works now.
   Fixed a memory leak in PreProcessEvt().
 
VaDevice -
   Interface modified to accomodate above changes.
   FindHeaders() does not need a TaEvent.

